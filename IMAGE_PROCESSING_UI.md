# Image Processing UI Guide

## Where to Find Image Processing Settings

When configuring a File type field in Saltcorn, the image processing options appear in the field's attributes section.

### Navigation Path

1. Go to **Tables** menu
2. Select your table
3. Click on a File field or create a new one
4. In the field editor, navigate to the **Attributes** step/tab

### Field Configuration UI

The image processing configuration appears as a section in the field attributes form:

```
┌─ Attributes ──────────────────────────────────────────┐
│                                                        │
│ Role required to access added files                   │
│ [Dropdown: Staff ▼]                                   │
│ The user uploading the file has access...             │
│                                                        │
│ ☑ Cascade delete to file                             │
│ Deleting a row will also delete the file...          │
│                                                        │
│ Files accept filter                                    │
│ [Input: image/*                                    ]   │
│ Specifies a filter for what file types...            │
│                                                        │
│ ☑ Process images on upload ← NEW!                    │
│ Automatically resize, compress, and/or...             │
│                                                        │
│ Target width (pixels)                                 │
│ [Input: 800                                        ]   │
│ Maximum width for uploaded images...                  │
│                                                        │
│ Target height (pixels)                                │
│ [Input:                                            ]   │
│ Maximum height for uploaded images...                 │
│                                                        │
│ Target format                                         │
│ [Dropdown: WebP ▼]                                    │
│ Convert images to this format...                      │
│                                                        │
│ Compression quality (1-100)                           │
│ [Input: 85                                         ]   │
│ Higher values mean better quality...                  │
│                                                        │
│ ☐ Keep original file                                 │
│ Store both the original and processed...              │
│                                                        │
└────────────────────────────────────────────────────────┘
```

### Show/Hide Behavior

The image processing options use conditional display:

- When "Process images on upload" is **unchecked**: Only the checkbox is visible
- When "Process images on upload" is **checked**: All sub-options appear

### Field Descriptions

Each option includes a sublabel with helpful information:

| Option | Description |
|--------|-------------|
| Process images on upload | Automatically resize, compress, and/or convert images when uploaded |
| Target width (pixels) | Maximum width for uploaded images. Leave empty to keep original width. |
| Target height (pixels) | Maximum height for uploaded images. Leave empty to keep original height. |
| Target format | Convert images to this format. WebP offers best compression. |
| Compression quality (1-100) | Higher values mean better quality but larger file size. Recommended: 80-90 |
| Keep original file | Store both the original and processed versions of the image |

### User Experience on Upload

When a user uploads an image through a form with image processing enabled:

1. **Before**: User clicks "Choose File" and selects an image
2. **During**: File uploads and processes (usually < 1 second for typical images)
3. **After**: Form shows the processed image file

The user sees the same upload flow - the processing happens transparently behind the scenes.

### Example Configurations in UI

**Profile Photo Setup:**
- ☑ Process images on upload
- Target width: `400`
- Target height: `400`
- Target format: `WebP`
- Compression quality: `85`
- ☐ Keep original file

**Product Gallery:**
- ☑ Process images on upload
- Target width: `1200`
- Target height: *(empty)*
- Target format: `JPEG`
- Compression quality: `90`
- ☑ Keep original file

**Document Compression:**
- ☑ Process images on upload
- Target width: *(empty)*
- Target height: *(empty)*
- Target format: *(keep original format)*
- Compression quality: `75`
- ☐ Keep original file

## Developer Notes

The UI form is generated by the field configuration code in:
`packages/server/routes/fields.js`

The form uses Saltcorn's standard Field form API with `showIf` conditions to control visibility of the image processing sub-options based on the `process_images` checkbox state.
